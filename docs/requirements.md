# スマートレシピファインダー 要件定義書

## 1. プロジェクト概要
**目的**: 料理初心者向けの材料検索型レシピアプリで、日常の献立決めと食材ロス削減を支援  
**開発期間**: 2週間  
**アピールポイント**: Next.js + Supabaseでのフルスタック実装

## 2. ターゲットユーザー
- 料理初心者
- 日常的に献立に悩む人
- 冷蔵庫の食材を使い切りたい人

## 3. 主要機能

### 3.1 材料検索機能
- テキスト入力で複数材料を登録
- 材料のタグ表示・削除機能
- 入力補助(オートコンプリート)

### 3.2 レシピ表示機能
- AIレシピ生成(Gemini 2.5 Flash使用)
- 既存レシピDB検索(無料API or スクレイピング)
- 混在表示(生成・既存を区別なく一覧表示)
- レシピ詳細: 材料、手順、調理時間、難易度
- **追加で必要な材料の明示**

### 3.3 代替材料提案機能
- AIが材料の代替案を提案
- 不足している材料がある場合の代用提案

### 3.4 お気に入り機能
- ユーザー認証(Supabase Auth)
- お気に入り登録/解除
- お気に入り一覧ページ
- お気に入りからの削除

### 3.5 ユーザー管理
- メールアドレス/パスワードでの認証
- ログイン/ログアウト
- 新規登録

## 4. 技術スタック

### フロントエンド
- **Framework**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **状態管理**: React Hooks (必要に応じてContext API)
- **UI**: モバイルファースト、シンプルデザイン

### バックエンド
- **BaaS**: Supabase
  - 認証(Supabase Auth)
  - データベース(PostgreSQL)
  - お気に入りデータ保存

### AI
- **API**: Google Gemini 2.5 Flash(無料枠)
- **用途**: レシピ生成、代替材料提案

### 既存レシピ取得
- Spoonacular API（無料枠: 150リクエスト/日）

## 5. データベース設計(Supabase)

### テーブル構成案

**users** (Supabase Authで自動管理)
- id (UUID)
- email
- created_at

**favorites**
- id (UUID, Primary Key)
- user_id (UUID, Foreign Key → users)
- recipe_data (JSONB) - レシピ全体を保存
- created_at (Timestamp)

**※レシピデータはJSONBで保存し、柔軟に対応**

## 6. 画面構成

### 6.1 トップページ(/)
- 材料入力フォーム
- 検索ボタン
- ログイン状態の表示

### 6.2 レシピ一覧ページ(/recipes)
- 検索結果表示(カード形式)
- お気に入りボタン
- レシピ詳細へのリンク
- **再生成ボタン**: 新しいレシピを探す（キャッシュをクリアして再取得）
- **キャッシュインジケーター**: キャッシュから読み込んだ場合に表示

### 6.3 レシピ詳細ページ(/recipes/[id])
- 材料リスト(手持ち/追加購入を区別)
- 調理手順
- 代替材料提案ボタン
- お気に入り登録/解除

### 6.4 お気に入りページ(/favorites)
- 保存したレシピ一覧
- 削除機能

### 6.5 認証ページ(/auth)
- ログイン
- 新規登録

## 7. 非機能要件

- **レスポンシブ対応**: モバイルファースト
- **パフォーマンス**:
  - 検索結果表示3秒以内
  - **レシピキャッシュ機能**: 同じ材料での再検索時はsessionStorageのキャッシュを使用し、API呼び出しを回避
    - キャッシュキー: 材料をソートして順序非依存（例: "玉ねぎ,にんじん" と "にんじん,玉ねぎ" は同じキャッシュ）
    - 有効期限: セッション中のみ（タブを閉じるまで）
    - 再生成: 「新しいレシピを探す」ボタンでキャッシュをクリアして新規取得
  - レシピ詳細から「戻る」で戻った時もキャッシュから即座に表示
- **セキュリティ**: Supabase RLSでデータ保護
- **コスト**: Gemini無料枠内で運用、API呼び出し削減のためキャッシュを活用

## 8. 開発フェーズ(2週間)

### Week 1
- Day 1-2: プロジェクトセットアップ、Supabase設定
- Day 3-4: 材料入力・検索UI実装
- Day 5-7: Gemini API統合、レシピ生成機能

### Week 2
- Day 8-9: 既存レシピAPI/スクレイピング実装
- Day 10-11: 認証・お気に入り機能
- Day 12-13: UI/UX調整、レスポンシブ対応
- Day 14: テスト・デプロイ(Vercel)

## 9. 今後の拡張可能性

- ユーザーの好みや制約(アレルギー、ベジタリアン等)への対応
- 栄養情報の表示
- ショッピングリスト自動生成
- レシピの評価・コメント機能
- 調理履歴の記録

---

**作成日**: 2025年11月1日
